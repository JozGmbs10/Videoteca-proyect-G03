@model List<EstudianteModel>

@{
    ViewData["Title"] = "Usuarios";
    var message = TempData["Message"] as string;
}

<link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />



<style>

    .custom-alert {
        position: fixed;
        bottom: 20px; /* Espacio desde el fondo */
        right: 20px; /* Espacio desde la derecha */
        z-index: 1050; /* Asegura que esté por encima de otros elementos */
        background-color: black; /* Fondo negro */
        color: white; /* Texto blanco */
        border: 1px solid white; /* Borde blanco opcional */
        padding: 10px; /* Espaciado interno */
        display: none; /* Oculta por defecto; se puede mostrar con JavaScript */
        border-radius: 5px; /* Esquinas redondeadas opcionales */
    }

</style>

<div class="container">
    <h2>Estudiantes</h2>
    <table class="table" id="estudiantesTable">
        <thead>
            <tr>
                <th>Id Estudiante</th>
                <th>Nombre</th>
                <th>Correo</th>
                <th>Estado</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            <!-- Aquí se agregarán filas dinámicamente -->
            @if (Model != null && Model.Any())
            {
                foreach (var estudiante in Model)
                {
                    <tr>
                        <td>@estudiante.IdEstudiante</td>
                        <td>@estudiante.Usuario.Nombre</td>  <!-- Nombre del estudiante -->
                        <td>@estudiante.Usuario.Correo</td>  <!-- Correo del estudiante -->
                        <td>@estudiante.Estado</td>  <!-- Estado del estudiante -->
                        <td>
                            <!-- Acciones -->
                            <button class="btn btn-primary btn-estudiante" data-id="@estudiante.IdEstudiante">
                                Ver
                            </button>
                        </td>
                    </tr>
                }
            }
            else
            {
                <tr>
                    <td colspan="4" class="text-warning">No hay estudiantes disponibles. Por favor, agrega un estudiante.</td>
                </tr>
            }
        </tbody>
    </table>
    <button class="btn btn-success" id="btnAddEstudiante">Agregar Estudiante</button>

    @if (!string.IsNullOrEmpty(message))
    {
        <div class="alert custom-alert" role="alert" id="error-message">
            @message
        </div>
    }

</div>

@* Modal para agregar estudiante *@
<div class="modal" id="addEstudianteModal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Agregar Estudiante</h5>
            </div>
            <div class="modal-body">
                <form id="addInventarioForm" method="post" action="@Url.Action("AddEstudiante", "Usuarios")">
                    <div class="form-group">
                        <label>Nombre:</label> <input type="text" class="form-control" id="nombre" name="nombre" required />
                        <label>Correo:</label> <input type="text" class="form-control" id="correo" name="correo" required />
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-primary">Guardar</button>
                        <button type="button" class="btn btn-secondary" id="btnCancelAddEstudiante">Cancelar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

@section Scripts {
<script>
        let editMode = false;

        $(".btn-estudiante").click(function () {
            var idEstudiante = $(this).data('id');
            window.location.href = '@Url.Action("Estudiante", "Usuarios", new { idEstudiante = "__idEstudiante__" })'.replace('__idEstudiante__', idEstudiante);
        });

        $("#btnCancelAddEstudiante").click(function () {
            $('#addEstudianteModal').modal('hide');
        });

        $("#btnAddEstudiante").click(function () {
            $('#addEstudianteModal').modal('show');
        });

</script>
}